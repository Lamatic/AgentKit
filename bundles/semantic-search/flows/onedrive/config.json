{
  "nodes": [
    {
      "id": "triggerNode_1",
      "type": "triggerNode",
      "position": {
        "x": 0,
        "y": 0
      },
      "data": {
        "nodeId": "onedriveNode",
        "modes": {},
        "trigger": true,
        "values": {
          "nodeName": "Onedrive Business",
          "globs": [
            "**/*.pdf",
            "**/*.docx",
            "**/*.txt",
            "**/*.pptx",
            "**/*.md"
          ],
          "strategy": "auto",
          "syncMode": "incremental",
          "drive_name": "OneDrive",
          "start_date": "",
          "folder_path": ".",
          "search_scope": "ALL",
          "cronExpression": "0 0 00 ? * 1 * UTC",
          "days_to_sync_if_history_is_full": "3"
        }
      }
    },
    {
      "id": "chunkNode_318",
      "type": "dynamicNode",
      "position": {
        "x": 0,
        "y": 0
      },
      "data": {
        "nodeId": "chunkNode",
        "values": {
          "nodeName": "Chunking",
          "chunkField": "{{triggerNode_1.output.content}}",
          "numOfChars": 500,
          "separators": [
            "\n\n",
            "\n",
            " "
          ],
          "chunkingType": "recursiveCharacterTextSplitter",
          "overlapChars": 50
        }
      }
    },
    {
      "id": "codeNode_254",
      "type": "dynamicNode",
      "position": {
        "x": 0,
        "y": 0
      },
      "data": {
        "nodeId": "codeNode",
        "values": {
          "nodeName": "Get Chunks",
          "code": "let docs =  {{chunkNode_318.output.chunks}}\n\nlet outputDocs = docs.map(doc => doc.pageContent);\nconsole.log(outputDocs)\noutput = outputDocs;"
        }
      }
    },
    {
      "id": "vectorizeNode_639",
      "type": "dynamicNode",
      "position": {
        "x": 0,
        "y": 0
      },
      "data": {
        "nodeId": "vectorizeNode",
        "values": {
          "nodeName": "Vectorize",
          "inputText": "{{codeNode_254.output}}",
          "embeddingModelName": {},
          "generativeModelName": {}
        }
      }
    },
    {
      "id": "codeNode_507",
      "type": "dynamicNode",
      "position": {
        "x": 0,
        "y": 0
      },
      "data": {
        "nodeId": "codeNode",
        "values": {
          "nodeName": "Transform Metadata",
          "code": "let vectors = {{vectorizeNode_639.output.vectors}}\nlet metadataProps = [];\nlet texts = {{codeNode_254.output}};\n\nfor (const idx in vectors) {\n    let metadata = {}\n    metadata[\"content\"] = texts[idx];\n    metadata[\"title\"] = {{variablesNode_289.output.title}};\n    metadata[\"source\"] = {{variablesNode_289.output.source}};\n    metadata[\"last_modified\"] = {{variablesNode_289.output.last_modified}};\n    \n    metadataProps.push(metadata);\n}\n\noutput = {\"metadata\": metadataProps, \"vectors\": vectors}"
        }
      }
    },
    {
      "id": "IndexNode_622",
      "type": "dynamicNode",
      "position": {
        "x": 0,
        "y": 0
      },
      "data": {
        "nodeId": "IndexNode",
        "values": {
          "nodeName": "Index",
          "primaryKeys": [
            "file_name"
          ],
          "vectorsField": "{{vectorizeNode_639.output.vectors}}",
          "metadataField": "{{codeNode_507.output.metadata}}",
          "duplicateOperation": "overwrite"
        }
      }
    },
    {
      "id": "plus-node-addNode_960424",
      "type": "addNode",
      "position": {
        "x": 0,
        "y": 0
      },
      "data": {
        "nodeId": "addNode",
        "values": {
          "nodeName": ""
        }
      }
    },
    {
      "id": "variablesNode_289",
      "type": "dynamicNode",
      "position": {
        "x": 0,
        "y": 0
      },
      "data": {
        "nodeId": "variablesNode",
        "modes": {},
        "values": {
          "nodeName": "Variables",
          "mapping": "{\n  \"title\": {\n    \"type\": \"string\",\n    \"value\": \"{{triggerNode_1.output.document_key}}\"\n  },\n  \"last_modified\": {\n    \"type\": \"string\",\n    \"value\": \"{{triggerNode_1.output._ab_source_file_last_modified}}\"\n  },\n  \"source\": {\n    \"type\": \"string\",\n    \"value\": \"{{triggerNode_1.output._ab_source_file_url}}\"\n  }\n}"
        }
      }
    }
  ],
  "edges": [
    {
      "id": "variablesNode_289-chunkNode_318",
      "source": "variablesNode_289",
      "target": "chunkNode_318",
      "sourceHandle": "bottom",
      "targetHandle": "top",
      "type": "defaultEdge"
    },
    {
      "id": "chunkNode_318-codeNode_254",
      "source": "chunkNode_318",
      "target": "codeNode_254",
      "sourceHandle": "bottom",
      "targetHandle": "top",
      "type": "defaultEdge"
    },
    {
      "id": "codeNode_254-vectorizeNode_639",
      "source": "codeNode_254",
      "target": "vectorizeNode_639",
      "sourceHandle": "bottom",
      "targetHandle": "top",
      "type": "defaultEdge"
    },
    {
      "id": "vectorizeNode_639-codeNode_507",
      "source": "vectorizeNode_639",
      "target": "codeNode_507",
      "sourceHandle": "bottom",
      "targetHandle": "top",
      "type": "defaultEdge"
    },
    {
      "id": "codeNode_507-IndexNode_622",
      "source": "codeNode_507",
      "target": "IndexNode_622",
      "sourceHandle": "bottom",
      "targetHandle": "top",
      "type": "defaultEdge"
    },
    {
      "id": "IndexNode_622-plus-node-addNode_960424",
      "source": "IndexNode_622",
      "target": "plus-node-addNode_960424",
      "sourceHandle": "bottom",
      "targetHandle": "top",
      "type": "defaultEdge"
    },
    {
      "id": "triggerNode_1-variablesNode_289",
      "source": "triggerNode_1",
      "target": "variablesNode_289",
      "sourceHandle": "bottom",
      "targetHandle": "top",
      "type": "defaultEdge"
    }
  ]
}